<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="realTimeDeliveryCount">
  <select id="realTimeDeliveryCount">
    SELECT  dlvryStateCd,
            COUNT(*) AS dlvryCnt
      FROM  tb_deliveries AS dlvr
     WHERE  1=1
    <if test="stoBrcofcId != null and !stoBrcofcId.equal('')">
       AND  dlvr.stoBrcofcId = #{stoBrcofcId}
    </if>
    <if test="riderBrcofcId != null and !riderBrcofcId.equal('')">
       AND  dlvr.riderBrcofcId = #{riderBrcofcId}
    </if>
    <if test="dlvryRecvDtStd != null and !dlvryRecvDtStd.equal('')">
       AND  date_format(dlvr.dlvryRecvDt, "%Y%m%d%H%i%s") <![CDATA[ >= ]]> #{dlvryRecvDtStd}
    </if>
    <if test="dlvryRecvDtEnd != null and !dlvryRecvDtEnd.equal('')">
       AND  date_format(dlvr.dlvryRecvDt, "%Y%m%d%H%i%s") <![CDATA[ <= ]]> #{dlvryRecvDtEnd}
    </if>
     GROUP
        BY  dlvryStateCd
  </select>
</mapper>
